---
title: "index"
output: html_document
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ROAuth)
library(devtools)
library(twitteR)
library(plotly)
load("my_oauth.Rdata")
consumerKey <- my_oauth$consumerKey
consumerSecret <- my_oauth$consumerSecret
oauthKey <- my_oauth$oauthKey
oauthSecret <- my_oauth$oauthSecret

setup_twitter_oauth(consumerKey, consumerSecret, oauthKey, oauthSecret)

tweets = searchTwitter("election+us+2016",n=50, geocode="38,-95,2000mi")
tweets.df = do.call("rbind",lapply(tweets,as.data.frame))
g <- list(
  scope = 'usa',
  projection = list(type = 'albers usa'),
  showland = TRUE,
  landcolor = toRGB("gray85"),
  subunitwidth = 1,
  countrywidth = 1,
  subunitcolor = toRGB("white"),
  countrycolor = toRGB("white")
)
tweets.df$q <- with(tweets.df, cut(created, 5))
plot_ly(tweets.df, lat=latitude, lon=longitude, text=text, mode='markers', marker = list(size = 10, symbol = 'circle'), color=q, type="scattergeo", locationmode='USA-states')%>%layout(width = 900, height = 700, geo=g)

```